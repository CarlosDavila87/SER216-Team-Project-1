<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>GamePanel.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">testGame (Apr 13, 2015 4:53:57 PM)</a> &gt; <a href="../../index.html" class="el_group">ConnectFourGame</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.source.html" class="el_package">connect.four.gui</a> &gt; <span class="el_source">GamePanel.java</span></div><h1>GamePanel.java</h1><pre class="source lang-java linenums"><span class="nc" id="L1">/*</span>
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package connect.four.gui;

import connect.four.*;
import connect.four.board.*;
import connect.four.player.*;
import java.awt.Color;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.Timer;


public class GamePanel extends javax.swing.JPanel implements ScoreChart.Listener {

	GUI gui;
<span class="nc" id="L21">	static final long GLOW_START_TIME = (int)System.currentTimeMillis();</span>
<span class="nc" id="L22">	static final int PLAY_TIME = 1500;</span>
	boolean falling;
	int columnNum;
	int turnNum;
	int whoPlayed;
	int newDrawPos;
	int newColumnNum;
	Player[] players;
	Game game;
	GUIPiece[] pieces;
	Board board;
	boolean isComputerEnabled;
	boolean justWon;
	
<span class="nc" id="L36">	public GamePanel(GUI gui, boolean isComputerEnabled) {</span>
		//whoPlayed = 1;
<span class="nc" id="L38">		players = new Player[2];</span>
<span class="nc" id="L39">		players[0] = new GUIPlayer(gui.getPlayer1Name(), this);</span>
<span class="nc" id="L40">		this.isComputerEnabled = isComputerEnabled;</span>
<span class="nc bnc" id="L41" title="All 2 branches missed.">		if(!isComputerEnabled){</span>
<span class="nc" id="L42">			players[1] = new GUIPlayer(gui.getPlayer2Name(), this);</span>
<span class="nc" id="L43">		}</span>
		else{
<span class="nc" id="L45">			players[1] = new GUIWrapperPlayer(new ComputerPlayer(), this);</span>
		}
<span class="nc" id="L47">		setSize(1280, 800);</span>
<span class="nc" id="L48">		initComponents();</span>
<span class="nc" id="L49">		this.gui = gui;</span>
<span class="nc" id="L50">		board = new Board(7,6);</span>
<span class="nc" id="L51">		game = new Game(players,board, 4);</span>
<span class="nc" id="L52">		game.start();</span>
<span class="nc" id="L53">		game.registerListener(this);</span>
<span class="nc" id="L54">		justWon = false;</span>
		
<span class="nc" id="L56">		initNewGame();</span>
<span class="nc" id="L57">	}</span>

	/**
	 * This method is called from within the constructor to initialize the
	 * form. WARNING: Do NOT modify this code. The content of this method is
	 * always regenerated by the Form Editor.
	 */
	@SuppressWarnings(&quot;unchecked&quot;)
        // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;Generated Code&quot;&gt;//GEN-BEGIN:initComponents
        private void initComponents() {

<span class="nc" id="L68">                player1NameBox = new javax.swing.JLabel();</span>
<span class="nc" id="L69">                currentWins = new javax.swing.JLabel();</span>
<span class="nc" id="L70">                pNameDisplay = new javax.swing.JLabel();</span>
<span class="nc" id="L71">                turnDisplay = new javax.swing.JLabel();</span>
<span class="nc" id="L72">                col1 = new javax.swing.JPanel();</span>
<span class="nc" id="L73">                col2 = new javax.swing.JPanel();</span>
<span class="nc" id="L74">                col3 = new javax.swing.JPanel();</span>
<span class="nc" id="L75">                col4 = new javax.swing.JPanel();</span>
<span class="nc" id="L76">                col5 = new javax.swing.JPanel();</span>
<span class="nc" id="L77">                col6 = new javax.swing.JPanel();</span>
<span class="nc" id="L78">                topGlass = new javax.swing.JPanel();</span>
<span class="nc" id="L79">                col7 = new javax.swing.JPanel();</span>
<span class="nc" id="L80">                player2NameBox = new javax.swing.JLabel();</span>
<span class="nc" id="L81">                bgImage = new javax.swing.JLabel();</span>

<span class="nc" id="L83">                setBackground(new java.awt.Color(0, 0, 0));</span>
<span class="nc" id="L84">                setPreferredSize(new java.awt.Dimension(1280, 800));</span>
<span class="nc" id="L85">                addMouseListener(new java.awt.event.MouseAdapter() {</span>
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L87">                                formMouseClicked(evt);</span>
<span class="nc" id="L88">                        }</span>
                });
<span class="nc" id="L90">                setLayout(null);</span>

<span class="nc" id="L92">                player1NameBox.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 0, 18)); // NOI18N</span>
<span class="nc" id="L93">                player1NameBox.setForeground(new java.awt.Color(255, 255, 255));</span>
<span class="nc" id="L94">                player1NameBox.setText(&quot;player 1&quot;);</span>
<span class="nc" id="L95">                add(player1NameBox);</span>
<span class="nc" id="L96">                player1NameBox.setBounds(1070, 40, 210, 40);</span>

<span class="nc" id="L98">                currentWins.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 0, 18)); // NOI18N</span>
<span class="nc" id="L99">                currentWins.setForeground(new java.awt.Color(255, 255, 255));</span>
<span class="nc" id="L100">                currentWins.setText(&quot;CURRENT WINS&quot;);</span>
<span class="nc" id="L101">                add(currentWins);</span>
<span class="nc" id="L102">                currentWins.setBounds(1070, 0, 200, 40);</span>

<span class="nc" id="L104">                pNameDisplay.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 0, 18)); // NOI18N</span>
<span class="nc" id="L105">                pNameDisplay.setForeground(new java.awt.Color(255, 255, 255));</span>
<span class="nc" id="L106">                pNameDisplay.setText(&quot;jLabel2&quot;);</span>
<span class="nc" id="L107">                add(pNameDisplay);</span>
<span class="nc" id="L108">                pNameDisplay.setBounds(1070, 210, 200, 40);</span>

<span class="nc" id="L110">                turnDisplay.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 0, 18)); // NOI18N</span>
<span class="nc" id="L111">                turnDisplay.setForeground(new java.awt.Color(255, 255, 255));</span>
<span class="nc" id="L112">                turnDisplay.setText(&quot;jLabel2&quot;);</span>
<span class="nc" id="L113">                add(turnDisplay);</span>
<span class="nc" id="L114">                turnDisplay.setBounds(1070, 150, 200, 40);</span>

<span class="nc" id="L116">                col1.setBackground(new java.awt.Color(102, 102, 102));</span>
<span class="nc" id="L117">                col1.setOpaque(false);</span>
<span class="nc" id="L118">                col1.addMouseListener(new java.awt.event.MouseAdapter() {</span>
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L120">                                col1MouseClicked(evt);</span>
<span class="nc" id="L121">                        }</span>
                        public void mouseExited(java.awt.event.MouseEvent evt) {
<span class="nc" id="L123">                                col1MouseExited(evt);</span>
<span class="nc" id="L124">                        }</span>
                        public void mouseEntered(java.awt.event.MouseEvent evt) {
<span class="nc" id="L126">                                col1MouseEntered(evt);</span>
<span class="nc" id="L127">                        }</span>
                });
<span class="nc" id="L129">                col1.setLayout(null);</span>
<span class="nc" id="L130">                add(col1);</span>
<span class="nc" id="L131">                col1.setBounds(0, 0, 310, 740);</span>

<span class="nc" id="L133">                col2.setBackground(new java.awt.Color(102, 102, 102));</span>
<span class="nc" id="L134">                col2.setOpaque(false);</span>
<span class="nc" id="L135">                col2.addMouseListener(new java.awt.event.MouseAdapter() {</span>
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L137">                                col2MouseClicked(evt);</span>
<span class="nc" id="L138">                        }</span>
                        public void mouseExited(java.awt.event.MouseEvent evt) {
<span class="nc" id="L140">                                col2MouseExited(evt);</span>
<span class="nc" id="L141">                        }</span>
                        public void mouseEntered(java.awt.event.MouseEvent evt) {
<span class="nc" id="L143">                                col2MouseEntered(evt);</span>
<span class="nc" id="L144">                        }</span>
                });
<span class="nc" id="L146">                col2.setLayout(null);</span>
<span class="nc" id="L147">                add(col2);</span>
<span class="nc" id="L148">                col2.setBounds(320, 0, 80, 740);</span>

<span class="nc" id="L150">                col3.setBackground(new java.awt.Color(102, 102, 102));</span>
<span class="nc" id="L151">                col3.setOpaque(false);</span>
<span class="nc" id="L152">                col3.addMouseListener(new java.awt.event.MouseAdapter() {</span>
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L154">                                col3MouseClicked(evt);</span>
<span class="nc" id="L155">                        }</span>
                        public void mouseExited(java.awt.event.MouseEvent evt) {
<span class="nc" id="L157">                                col3MouseExited(evt);</span>
<span class="nc" id="L158">                        }</span>
                        public void mouseEntered(java.awt.event.MouseEvent evt) {
<span class="nc" id="L160">                                col3MouseEntered(evt);</span>
<span class="nc" id="L161">                        }</span>
                });
<span class="nc" id="L163">                col3.setLayout(null);</span>
<span class="nc" id="L164">                add(col3);</span>
<span class="nc" id="L165">                col3.setBounds(410, 10, 80, 740);</span>

<span class="nc" id="L167">                col4.setBackground(new java.awt.Color(102, 102, 102));</span>
<span class="nc" id="L168">                col4.setOpaque(false);</span>
<span class="nc" id="L169">                col4.addMouseListener(new java.awt.event.MouseAdapter() {</span>
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L171">                                col4MouseClicked(evt);</span>
<span class="nc" id="L172">                        }</span>
                        public void mouseExited(java.awt.event.MouseEvent evt) {
<span class="nc" id="L174">                                col4MouseExited(evt);</span>
<span class="nc" id="L175">                        }</span>
                        public void mouseEntered(java.awt.event.MouseEvent evt) {
<span class="nc" id="L177">                                col4MouseEntered(evt);</span>
<span class="nc" id="L178">                        }</span>
                });
<span class="nc" id="L180">                col4.setLayout(null);</span>
<span class="nc" id="L181">                add(col4);</span>
<span class="nc" id="L182">                col4.setBounds(500, -10, 80, 740);</span>

<span class="nc" id="L184">                col5.setBackground(new java.awt.Color(102, 102, 102));</span>
<span class="nc" id="L185">                col5.setOpaque(false);</span>
<span class="nc" id="L186">                col5.addMouseListener(new java.awt.event.MouseAdapter() {</span>
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L188">                                col5MouseClicked(evt);</span>
<span class="nc" id="L189">                        }</span>
                        public void mouseExited(java.awt.event.MouseEvent evt) {
<span class="nc" id="L191">                                col5MouseExited(evt);</span>
<span class="nc" id="L192">                        }</span>
                        public void mouseEntered(java.awt.event.MouseEvent evt) {
<span class="nc" id="L194">                                col5MouseEntered(evt);</span>
<span class="nc" id="L195">                        }</span>
                });
<span class="nc" id="L197">                col5.setLayout(null);</span>
<span class="nc" id="L198">                add(col5);</span>
<span class="nc" id="L199">                col5.setBounds(590, 0, 80, 740);</span>

<span class="nc" id="L201">                col6.setBackground(new java.awt.Color(102, 102, 102));</span>
<span class="nc" id="L202">                col6.setOpaque(false);</span>
<span class="nc" id="L203">                col6.addMouseListener(new java.awt.event.MouseAdapter() {</span>
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L205">                                col6MouseClicked(evt);</span>
<span class="nc" id="L206">                        }</span>
                        public void mouseExited(java.awt.event.MouseEvent evt) {
<span class="nc" id="L208">                                col6MouseExited(evt);</span>
<span class="nc" id="L209">                        }</span>
                        public void mouseEntered(java.awt.event.MouseEvent evt) {
<span class="nc" id="L211">                                col6MouseEntered(evt);</span>
<span class="nc" id="L212">                        }</span>
                });
<span class="nc" id="L214">                col6.setLayout(null);</span>
<span class="nc" id="L215">                add(col6);</span>
<span class="nc" id="L216">                col6.setBounds(680, -30, 80, 740);</span>

<span class="nc" id="L218">                topGlass.setBackground(new java.awt.Color(102, 102, 102));</span>
<span class="nc" id="L219">                topGlass.setOpaque(false);</span>
<span class="nc" id="L220">                topGlass.addMouseListener(new java.awt.event.MouseAdapter() {</span>
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L222">                                topGlassMouseClicked(evt);</span>
<span class="nc" id="L223">                        }</span>
                        public void mouseExited(java.awt.event.MouseEvent evt) {
<span class="nc" id="L225">                                topGlassMouseExited(evt);</span>
<span class="nc" id="L226">                        }</span>
                        public void mouseEntered(java.awt.event.MouseEvent evt) {
<span class="nc" id="L228">                                topGlassMouseEntered(evt);</span>
<span class="nc" id="L229">                        }</span>
                });
<span class="nc" id="L231">                topGlass.setLayout(null);</span>

<span class="nc" id="L233">                col7.setBackground(new java.awt.Color(102, 102, 102));</span>
<span class="nc" id="L234">                col7.setOpaque(false);</span>
<span class="nc" id="L235">                col7.addMouseListener(new java.awt.event.MouseAdapter() {</span>
                        public void mouseClicked(java.awt.event.MouseEvent evt) {
<span class="nc" id="L237">                                col7MouseClicked(evt);</span>
<span class="nc" id="L238">                        }</span>
                        public void mouseExited(java.awt.event.MouseEvent evt) {
<span class="nc" id="L240">                                col7MouseExited(evt);</span>
<span class="nc" id="L241">                        }</span>
                        public void mouseEntered(java.awt.event.MouseEvent evt) {
<span class="nc" id="L243">                                col7MouseEntered(evt);</span>
<span class="nc" id="L244">                        }</span>
                });
<span class="nc" id="L246">                col7.setLayout(null);</span>
<span class="nc" id="L247">                topGlass.add(col7);</span>
<span class="nc" id="L248">                col7.setBounds(770, 0, 300, 740);</span>

<span class="nc" id="L250">                player2NameBox.setFont(new java.awt.Font(&quot;Lucida Grande&quot;, 0, 18)); // NOI18N</span>
<span class="nc" id="L251">                player2NameBox.setForeground(new java.awt.Color(255, 255, 255));</span>
<span class="nc" id="L252">                player2NameBox.setText(&quot;player 1&quot;);</span>
<span class="nc" id="L253">                topGlass.add(player2NameBox);</span>
<span class="nc" id="L254">                player2NameBox.setBounds(1070, 90, 210, 40);</span>

<span class="nc" id="L256">                add(topGlass);</span>
<span class="nc" id="L257">                topGlass.setBounds(0, 0, 1280, 800);</span>

<span class="nc" id="L259">                bgImage.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/board.png&quot;))); // NOI18N</span>
<span class="nc" id="L260">                bgImage.setText(&quot;jLabel1&quot;);</span>
<span class="nc" id="L261">                bgImage.setIgnoreRepaint(true);</span>
<span class="nc" id="L262">                add(bgImage);</span>
<span class="nc" id="L263">                bgImage.setBounds(0, 150, 1070, 590);</span>
<span class="nc" id="L264">        }// &lt;/editor-fold&gt;//GEN-END:initComponents</span>

        private void col1MouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col1MouseEntered
<span class="nc" id="L267">		calcNewPos(0);</span>
<span class="nc" id="L268">		calcWidth(0);</span>
<span class="nc" id="L269">        }//GEN-LAST:event_col1MouseEntered</span>

        private void col1MouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col1MouseExited
	
<span class="nc" id="L273">        }//GEN-LAST:event_col1MouseExited</span>

        private void col2MouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col2MouseExited
  
<span class="nc" id="L277">        }//GEN-LAST:event_col2MouseExited</span>

        private void col2MouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col2MouseEntered
<span class="nc" id="L280">                calcNewPos(1);</span>
<span class="nc" id="L281">		calcWidth(1);</span>
<span class="nc" id="L282">        }//GEN-LAST:event_col2MouseEntered</span>

        private void col4MouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col4MouseExited
                // TODO add your handling code here:
<span class="nc" id="L286">        }//GEN-LAST:event_col4MouseExited</span>

        private void col4MouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col4MouseEntered
<span class="nc" id="L289">                calcNewPos(3);</span>
<span class="nc" id="L290">		calcWidth(3);</span>
<span class="nc" id="L291">        }//GEN-LAST:event_col4MouseEntered</span>

        private void col5MouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col5MouseExited
                // TODO add your handling code here:
<span class="nc" id="L295">        }//GEN-LAST:event_col5MouseExited</span>

        private void col5MouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col5MouseEntered
<span class="nc" id="L298">                calcNewPos(4);</span>
<span class="nc" id="L299">		calcWidth(4);</span>
<span class="nc" id="L300">        }//GEN-LAST:event_col5MouseEntered</span>

        private void col6MouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col6MouseExited
                // TODO add your handling code here:
<span class="nc" id="L304">        }//GEN-LAST:event_col6MouseExited</span>

        private void col6MouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col6MouseEntered
<span class="nc" id="L307">		calcNewPos(5);</span>
<span class="nc" id="L308">		calcWidth(5);</span>
<span class="nc" id="L309">        }//GEN-LAST:event_col6MouseEntered</span>

        private void col7MouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col7MouseExited
                // TODO add your handling code here:
<span class="nc" id="L313">        }//GEN-LAST:event_col7MouseExited</span>

        private void col7MouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col7MouseEntered
<span class="nc" id="L316">		calcNewPos(6);</span>
<span class="nc" id="L317">		calcWidth(6);</span>
<span class="nc" id="L318">        }//GEN-LAST:event_col7MouseEntered</span>

        private void col3MouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col3MouseExited
                // TODO add your handling code here:
<span class="nc" id="L322">        }//GEN-LAST:event_col3MouseExited</span>

        private void col3MouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col3MouseEntered
<span class="nc" id="L325">                calcNewPos(2);</span>
<span class="nc" id="L326">		calcWidth(2);</span>
<span class="nc" id="L327">        }//GEN-LAST:event_col3MouseEntered</span>

        private void formMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_formMouseClicked
  
<span class="nc" id="L331">        }//GEN-LAST:event_formMouseClicked</span>

        private void col1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col1MouseClicked
<span class="nc bnc" id="L334" title="All 4 branches missed.">                if (game.getCurrentPlayer() != players[1] || !isComputerEnabled) turn();</span>
<span class="nc" id="L335">        }//GEN-LAST:event_col1MouseClicked</span>

        private void col2MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col2MouseClicked
<span class="nc bnc" id="L338" title="All 4 branches missed.">                if (game.getCurrentPlayer() != players[1] || !isComputerEnabled) turn();</span>
<span class="nc" id="L339">        }//GEN-LAST:event_col2MouseClicked</span>

        private void col3MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col3MouseClicked
<span class="nc bnc" id="L342" title="All 4 branches missed.">                if (game.getCurrentPlayer() != players[1] || !isComputerEnabled) turn();</span>
<span class="nc" id="L343">        }//GEN-LAST:event_col3MouseClicked</span>

        private void col4MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col4MouseClicked
<span class="nc bnc" id="L346" title="All 4 branches missed.">                if (game.getCurrentPlayer() != players[1] || !isComputerEnabled) turn();</span>
<span class="nc" id="L347">        }//GEN-LAST:event_col4MouseClicked</span>

        private void col6MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col6MouseClicked
<span class="nc bnc" id="L350" title="All 4 branches missed.">                if (game.getCurrentPlayer() != players[1] || !isComputerEnabled) turn();</span>
<span class="nc" id="L351">        }//GEN-LAST:event_col6MouseClicked</span>

        private void col7MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col7MouseClicked
<span class="nc bnc" id="L354" title="All 4 branches missed.">                if (game.getCurrentPlayer() != players[1] || !isComputerEnabled) turn();</span>
<span class="nc" id="L355">        }//GEN-LAST:event_col7MouseClicked</span>

        private void col5MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_col5MouseClicked
<span class="nc bnc" id="L358" title="All 4 branches missed.">                if (game.getCurrentPlayer() != players[1] || !isComputerEnabled) turn();</span>
<span class="nc" id="L359">        }//GEN-LAST:event_col5MouseClicked</span>

        private void topGlassMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_topGlassMouseClicked
                // TODO add your handling code here:
<span class="nc" id="L363">        }//GEN-LAST:event_topGlassMouseClicked</span>

        private void topGlassMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_topGlassMouseExited
                // TODO add your handling code here:
<span class="nc" id="L367">        }//GEN-LAST:event_topGlassMouseExited</span>

        private void topGlassMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_topGlassMouseEntered
                // TODO add your handling code here:
<span class="nc" id="L371">        }//GEN-LAST:event_topGlassMouseEntered</span>

	
	void dropPiece(){
<span class="nc" id="L375">		falling = true;</span>
<span class="nc" id="L376">		final int destination = getTargetY();</span>
<span class="nc" id="L377">		final long startTime = System.currentTimeMillis();</span>
<span class="nc" id="L378">		pieces[turnNum].setVisible(true);</span>
<span class="nc" id="L379">		Timer timer = new Timer((8000/(destination)), new ActionListener() </span>
		{
		    @Override
                    public void actionPerformed(ActionEvent e) {
<span class="nc" id="L383">			int x = pieces[turnNum].getX();</span>
<span class="nc" id="L384">			int y = pieces[turnNum].getY();</span>
<span class="nc" id="L385">			int startY = y;</span>
<span class="nc" id="L386">			long duration = System.currentTimeMillis() - startTime;</span>
<span class="nc" id="L387">			float progress = (float)duration / (float)PLAY_TIME;</span>
			
<span class="nc bnc" id="L389" title="All 2 branches missed.">			if (progress &gt; 1f) </span>
			{
<span class="nc" id="L391">				progress = 1f;</span>
<span class="nc" id="L392">				((Timer)(e.getSource())).stop();</span>
<span class="nc" id="L393">				falling = false;</span>
<span class="nc" id="L394">				System.out.println(&quot;Piece fell.&quot;);</span>
<span class="nc bnc" id="L395" title="All 2 branches missed.">				if(!isComputerEnabled){</span>
<span class="nc" id="L396">					GUIPlayer player = (GUIPlayer)game.getCurrentPlayer();</span>
<span class="nc" id="L397">					player.getBoard().play(getColumnNum(), player);</span>
<span class="nc" id="L398">				}</span>
				else{
<span class="nc bnc" id="L400" title="All 2 branches missed.">					if(game.getCurrentPlayer() == players[0]){</span>
<span class="nc" id="L401">						GUIPlayer player = (GUIPlayer)game.getCurrentPlayer();</span>
<span class="nc" id="L402">						player.getBoard().play(getColumnNum(), player);</span>
<span class="nc" id="L403">					}</span>
<span class="nc bnc" id="L404" title="All 2 branches missed.">					else if(game.getCurrentPlayer() == players[1]){</span>
<span class="nc" id="L405">						GUIWrapperPlayer player = (GUIWrapperPlayer)game.getCurrentPlayer();						   player.getBoard().play(getColumnNum(), player);</span>
					}
					
				}
<span class="nc" id="L409">				turnUp();</span>
			}
<span class="nc" id="L411">			y = y+(int)Math.round((destination - startY) * progress);</span>
<span class="nc" id="L412">			pieces[turnNum].setLocation(x, y);</span>
<span class="nc bnc" id="L413" title="All 2 branches missed.">			if(y == getTargetY()){</span>
<span class="nc" id="L414">				((Timer)(e.getSource())).stop();</span>
<span class="nc" id="L415">				falling = false;</span>
<span class="nc" id="L416">				System.out.println(&quot;Piece fell.&quot;);</span>
<span class="nc bnc" id="L417" title="All 2 branches missed.">				if(!isComputerEnabled){</span>
<span class="nc" id="L418">					GUIPlayer player = (GUIPlayer)game.getCurrentPlayer();</span>
<span class="nc" id="L419">					player.getBoard().play(getColumnNum(), player);</span>
<span class="nc" id="L420">				}</span>
				else{
<span class="nc bnc" id="L422" title="All 2 branches missed.">					if(game.getCurrentPlayer() == players[0]){</span>
<span class="nc" id="L423">						GUIPlayer player = (GUIPlayer)game.getCurrentPlayer();</span>
<span class="nc" id="L424">						player.getBoard().play(getColumnNum(), player);</span>
<span class="nc" id="L425">					}</span>
<span class="nc bnc" id="L426" title="All 2 branches missed.">					else if(game.getCurrentPlayer() == players[1]){</span>
<span class="nc" id="L427">						GUIWrapperPlayer player = (GUIWrapperPlayer)game.getCurrentPlayer();						   player.getBoard().play(getColumnNum(), player);</span>
					}
				}
				
<span class="nc" id="L431">				turnUp();</span>
			}
<span class="nc" id="L433">		    }</span>
		});
<span class="nc" id="L435">		timer.start();</span>
<span class="nc" id="L436">	}</span>
	
	
	
	
	public int getTargetY(){
<span class="nc" id="L442">		int height = board.getColumnHeight(getColumnNum());</span>
<span class="nc bnc" id="L443" title="All 7 branches missed.">		switch(height){</span>
			case 0: 
<span class="nc" id="L445">				return 605;</span>
			case 1:
<span class="nc" id="L447">				return 513;</span>
			case 2:
<span class="nc" id="L449">				return 421;</span>
			case 3:
<span class="nc" id="L451">				return 330;</span>
			case 4:
<span class="nc" id="L453">				return 242;</span>
			case 5:
<span class="nc" id="L455">				return 150;</span>
			default:
<span class="nc" id="L457">				return 150;</span>
		}
	}
	
	public boolean isValidMove(){
<span class="nc" id="L462">		boolean valid = true;</span>
<span class="nc bnc" id="L463" title="All 2 branches missed.">		if(board.getColumnHeight(getColumnNum()) &gt; 5){</span>
<span class="nc" id="L464">			valid = false;</span>
		}
<span class="nc" id="L466">		return valid;</span>
	}
	
	public int getColumnNum(){
<span class="nc" id="L470">		return columnNum;</span>
	}
	
	public void calcWidth(int columnEntered){
<span class="nc" id="L474">		int xPos = 0;</span>
		
<span class="nc bnc" id="L476" title="All 8 branches missed.">		switch(columnEntered){</span>
			case 0:
<span class="nc" id="L478">				xPos = 190;</span>
<span class="nc" id="L479">				break;</span>
			case 1:
<span class="nc" id="L481">				xPos = 280;</span>
<span class="nc" id="L482">				break;</span>
			case 2:
<span class="nc" id="L484">				xPos = 372;</span>
<span class="nc" id="L485">				break;</span>
			case 3:
<span class="nc" id="L487">				xPos = 463;</span>
<span class="nc" id="L488">				break;</span>
			case 4:
<span class="nc" id="L490">				xPos = 554;</span>
<span class="nc" id="L491">				break;</span>
			case 5:
<span class="nc" id="L493">				xPos = 645;</span>
<span class="nc" id="L494">				break;</span>
			case 6:
<span class="nc" id="L496">				xPos = 738;</span>
				break;
			}
		
		
		
<span class="nc bnc" id="L502" title="All 2 branches missed.">		if(falling == false){</span>
<span class="nc" id="L503">			columnNum = columnEntered;</span>
<span class="nc" id="L504">			pieces[turnNum].setLocation(xPos,0);</span>
<span class="nc" id="L505">			revalidate();</span>
<span class="nc" id="L506">			repaint();</span>
		}
<span class="nc" id="L508">	}</span>
	
	void calcNewPos(int columnEntered){
<span class="nc" id="L511">		int xPos = 0;</span>
		
<span class="nc bnc" id="L513" title="All 8 branches missed.">		switch(columnEntered){</span>
			case 0:
<span class="nc" id="L515">				xPos = 190;</span>
<span class="nc" id="L516">				break;</span>
			case 1:
<span class="nc" id="L518">				xPos = 280;</span>
<span class="nc" id="L519">				break;</span>
			case 2:
<span class="nc" id="L521">				xPos = 372;</span>
<span class="nc" id="L522">				break;</span>
			case 3:
<span class="nc" id="L524">				xPos = 463;</span>
<span class="nc" id="L525">				break;</span>
			case 4:
<span class="nc" id="L527">				xPos = 554;</span>
<span class="nc" id="L528">				break;</span>
			case 5:
<span class="nc" id="L530">				xPos = 645;</span>
<span class="nc" id="L531">				break;</span>
			case 6:
<span class="nc" id="L533">				xPos = 738;</span>
				break;
			}
		
<span class="nc" id="L537">		newDrawPos = xPos;</span>
<span class="nc" id="L538">		newColumnNum = columnEntered;</span>
		
<span class="nc" id="L540">	}</span>
	
	void turnUp(){
<span class="nc bnc" id="L543" title="All 2 branches missed.">		if(!justWon){</span>
<span class="nc bnc" id="L544" title="All 2 branches missed.">			if(falling == false){</span>
				//move piece to top glass, for glow.
<span class="nc" id="L546">				glow(pieces[turnNum]);</span>

<span class="nc" id="L548">				turnNum +=1;</span>

				//Displays who is playing this turn
<span class="nc bnc" id="L551" title="All 2 branches missed.">				if(turnNum%2 == 0){</span>
<span class="nc" id="L552">					pNameDisplay.setForeground(Color.red);</span>
<span class="nc" id="L553">				}</span>
				else{
<span class="nc" id="L555">					pNameDisplay.setForeground(Color.blue);</span>
				}

				//Turn goes up, unless there is a tie
<span class="nc bnc" id="L559" title="All 2 branches missed.">				if(turnNum == 42){</span>
<span class="nc bnc" id="L560" title="All 2 branches missed.">					for (GUIPiece piece : pieces) {</span>
<span class="nc" id="L561">						piece.setIcon(null);</span>
<span class="nc" id="L562">						topGlass.remove(piece);</span>
					}
<span class="nc" id="L564">					gui.setWinner(&quot;It's a tie!&quot;);</span>
<span class="nc" id="L565">					board.clear();</span>
<span class="nc" id="L566">					initNewGame();</span>
<span class="nc" id="L567">					gui.addGameOver();</span>
<span class="nc" id="L568">				}</span>
				else{
<span class="nc" id="L570">					pieces[turnNum] = new GUIPiece(turnNum%2);</span>
<span class="nc" id="L571">					pieces[turnNum].setLocation(newDrawPos,0);</span>
<span class="nc bnc" id="L572" title="All 2 branches missed.">					if (game.getCurrentPlayer() == players[1]</span>
<span class="nc bnc" id="L573" title="All 2 branches missed.">					    &amp;&amp; isComputerEnabled) {</span>
<span class="nc" id="L574">						pieces[turnNum].setVisible(false);</span>
					}
<span class="nc" id="L576">					columnNum = newColumnNum;</span>
<span class="nc" id="L577">					System.out.println(&quot;Turn &quot; + (turnNum+1) +&quot; Started!&quot;);</span>
<span class="nc" id="L578">					pNameDisplay.setText(game.getCurrentPlayer().getName() + &quot;'s turn.&quot;);</span>
<span class="nc" id="L579">					turnDisplay.setText(&quot;Round number &quot; +(turnNum/2+1));</span>
<span class="nc" id="L580">					add(pieces[turnNum]);</span>
				}

				//Makes the round display turn red if there are 10 or less turns
<span class="nc bnc" id="L584" title="All 2 branches missed.">				if(turnNum &gt;= 32){</span>
					//Turns red to show 10 turns left
<span class="nc" id="L586">					turnDisplay.setForeground(Color.red);</span>
				}

<span class="nc" id="L589">				revalidate();</span>
<span class="nc" id="L590">				repaint();</span>


			}
<span class="nc" id="L594">		}</span>
		else{
<span class="nc" id="L596">			justWon = false;</span>
		}
<span class="nc" id="L598">	}</span>
	
	public void turn(){
<span class="nc bnc" id="L601" title="All 4 branches missed.">		if(falling == false &amp;&amp; isValidMove()){</span>
<span class="nc" id="L602">			System.out.println(getColumnNum());</span>
<span class="nc" id="L603">			System.out.println(board.getColumnHeight(getColumnNum()));</span>
<span class="nc" id="L604">			dropPiece();</span>
		}
<span class="nc" id="L606">	}</span>
	
	void initNewGame(){
<span class="nc" id="L609">		turnNum = 0;</span>
<span class="nc" id="L610">		columnNum = 0;</span>
<span class="nc" id="L611">		whoPlayed = 1;</span>
<span class="nc" id="L612">		falling = false;</span>
<span class="nc" id="L613">		pieces = new GUIPiece[43];</span>
<span class="nc" id="L614">		pieces[turnNum] = new GUIPiece(turnNum);</span>
<span class="nc" id="L615">		pieces[turnNum].setLocation(newDrawPos, 0);</span>
<span class="nc bnc" id="L616" title="All 4 branches missed.">		if (game.getCurrentPlayer() == players[1] &amp;&amp; isComputerEnabled) {</span>
<span class="nc" id="L617">			pieces[turnNum].setVisible(false);</span>
		}
<span class="nc" id="L619">		add(pieces[turnNum]);</span>
<span class="nc" id="L620">		pNameDisplay.setForeground(Color.red);</span>
<span class="nc" id="L621">		pNameDisplay.setText(game.getCurrentPlayer().getName() + &quot;'s turn.&quot;);</span>
<span class="nc" id="L622">		turnDisplay.setForeground(Color.white);</span>
<span class="nc" id="L623">		turnDisplay.setText(&quot;Round number &quot; +(turnNum/2+1));</span>
<span class="nc" id="L624">		player1NameBox.setText(players[0].getName() + &quot;:    &quot; + gui.getScore1());</span>
<span class="nc" id="L625">		player2NameBox.setText(players[1].getName() + &quot;:    &quot; + gui.getScore2());</span>
<span class="nc" id="L626">		setVisible(true);</span>
<span class="nc" id="L627">	}</span>
	
	void globalGlow(){
		
<span class="nc" id="L631">	}</span>
	
	//GAME OVER
	@Override
	public void gameOver(Player winner, ScoreChart scores, ReadableBoard end) {
<span class="nc bnc" id="L636" title="All 2 branches missed.">		if(turnNum &lt; 41){</span>
<span class="nc bnc" id="L637" title="All 2 branches missed.">			if(game.getCurrentPlayer() == players[0]){</span>
<span class="nc" id="L638">				gui.setScore1(gui.getScore1()+1);</span>
<span class="nc" id="L639">			}</span>
<span class="nc bnc" id="L640" title="All 2 branches missed.">			else if(game.getCurrentPlayer() == players[1]){</span>
<span class="nc" id="L641">				gui.setScore2(gui.getScore2()+1);</span>
			}
<span class="nc" id="L643">			gui.setWinner(game.getCurrentPlayer().getName());</span>
			
<span class="nc" id="L645">			board.clear();</span>
<span class="nc bnc" id="L646" title="All 2 branches missed.">			for (GUIPiece piece : pieces) {</span>
<span class="nc bnc" id="L647" title="All 2 branches missed.">						if(piece != null){</span>
<span class="nc" id="L648">							piece.setIcon(null);</span>
<span class="nc" id="L649">							topGlass.remove(piece);</span>
						}
					}
<span class="nc" id="L652">					initNewGame();</span>
<span class="nc" id="L653">					gui.addGameOver();</span>
<span class="nc" id="L654">					justWon = true;</span>
		}
<span class="nc" id="L656">	}</span>
	
	
	
	void glow(GUIPiece currentPiece){
<span class="nc" id="L661">		final GUIPiece cP = currentPiece;</span>
<span class="nc" id="L662">		topGlass.add(cP);</span>
<span class="nc" id="L663">		Timer timer = new Timer(100, new ActionListener() {</span>
			@Override
			public void actionPerformed(ActionEvent e) {
<span class="nc" id="L666">				long tick = GLOW_START_TIME - System.currentTimeMillis();</span>
<span class="nc" id="L667">				tick = (-1*tick/100);</span>
				//System.out.println(tick%6);
<span class="nc" id="L669">				cP.setIcon(cP.getGlow((int)tick%6));</span>
<span class="nc" id="L670">				topGlass.invalidate();</span>
<span class="nc" id="L671">				topGlass.revalidate();</span>
<span class="nc" id="L672">				topGlass.repaint();</span>
<span class="nc" id="L673">				}</span>

			
		    
		});
<span class="nc" id="L678">		timer.setRepeats(true);</span>
<span class="nc" id="L679">		timer.setCoalesce(true);</span>
<span class="nc" id="L680">		timer.start();</span>
<span class="nc" id="L681">	}</span>
	

        // Variables declaration - do not modify//GEN-BEGIN:variables
        private javax.swing.JLabel bgImage;
        private javax.swing.JPanel col1;
        private javax.swing.JPanel col2;
        private javax.swing.JPanel col3;
        private javax.swing.JPanel col4;
        private javax.swing.JPanel col5;
        private javax.swing.JPanel col6;
        private javax.swing.JPanel col7;
        private javax.swing.JLabel currentWins;
        private javax.swing.JLabel pNameDisplay;
        private javax.swing.JLabel player1NameBox;
        private javax.swing.JLabel player2NameBox;
        private javax.swing.JPanel topGlass;
        private javax.swing.JLabel turnDisplay;
        // End of variables declaration//GEN-END:variables

	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span>testGame (Apr 13, 2015 4:53:57 PM)</div></body></html>